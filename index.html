<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>

  <title>System Rules</title>
  <link rel="stylesheet" href="bootstrap.min.css" />
  <link rel="stylesheet" href="bootstrap-responsive.min.css" />
</head>

<body>
  <div class="navbar" data-scrollspy="scrollspy">
    <div class="navbar-inner">
      <div class="container">
        <a class="brand" href="#">System Rules</a>
        <ul class="nav">
          <li class="active"><a href="#">Home</a></li>
          <li><a href="download.html">Download/Add Dependency</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container">
		<header>
		  <div class="hero-unit">
		    <h1>System Rules</h1>
		    <p>A collection of JUnit rules for testing code which uses java.lang.System.</p>
				<p><a class="btn btn-primary btn-large" href="download.html">Get System Rules</a></p>
		  </div>
		</header>

		<h2>System Properties</h2>

		<p>There're three rules for testing code, which reads or
		writes system properties</p>

		<h3>Restore Properties</h3>
		<p>The RestoreSystemProperties rule restores the original value of
		the property when the test is finished.</p>
    <pre>
public void MyTest {
	&#064;Rule
	public final RestoreSystemProperties restoreSystemProperties
	 = new RestoreSystemProperties("MyProperty");

	&#064;Test
	public void overrideProperty() {
		//after the test the original value of "MyProperty" will be restored.
		System.setProperty("MyProperty", "other value");
		...
	}
}
		</pre>

		<h3>Clear Properties</h3>
		<p>The ClearSystemProperty rule deletes the property before the test
		and restores the original value of the property when the test is
		finished.</p>
		<pre>
public void MyTest {
	&#064;Rule
	public final ClearSystemProperty myPropertyIsCleared
	 = new ClearSystemProperty("MyProperty");

	&#064;Test
	public void overrideProperty() {
		assertNull(System.getProperty("MyProperty"));
	}
}
		</pre>

		<h3>Provide Properties</h3>
		<p>The ProvideSystemProperty rule provides an arbitrary value for a
		system property to a test. After the test the original value is
		restored.</p>
		<pre>
public void MyTest {
	&#064;Rule
	public final ProvideSystemProperty myPropertyHasMyValue
	 = new ProvideSystemProperty("MyProperty", "MyValue");

	&#064;Rule
	public final ProvideSystemProperty otherPropertyIsMissing
	 = new ProvideSystemProperty("OtherProperty", null);

	&#064;Test
	public void overrideProperty() {
		assertEquals("MyValue", System.getProperty("MyProperty"));
		assertNull(System.getProperty("OtherProperty"));
	}
}
		</pre>
		<p>You could also use a single instance of the rule to achieve the
		same effect:</p>
		<pre>
public void MyTest {
	&#064;Rule
	public final ProvideSystemProperty properties
	 = new ProvideSystemProperty("MyProperty", "MyValue").and("OtherProperty", null);

	&#064;Test
	public void overrideProperty() {
		assertEquals("MyValue", System.getProperty("MyProperty"));
		assertNull(System.getProperty("OtherProperty"));
	}
}
		</pre>

		<p>You can use a properties file to supply properties for the
ProvideSystemProperty rule. The file can be from the file system or the
class path. In the first case use</p>
		<pre>@Rule
public final ProvideSystemProperty properties
 = ProvideSystemProperty.fromFile("/home/myself/example.properties");</pre>

		<p>and in the second case use</p>
		<pre>@Rule
public final ProvideSystemProperty properties
 = ProvideSystemProperty.fromResource("example.properties");</pre>
    
		<h2>System.err and System.out</h2>
		<p>You want to verify the text, which your code writes to System.err
		or System.out. The StandardErrorStreamLog and
		StandardOutputStreamLog rule are logging everything written to
		System.err or System.out. The text is available by calling getLog().
		</p>
		<pre>
public void MyTest {
	&#064;Rule
	public final StandardErrorStreamLog log = new StandardErrorStreamLog();

	&#064;Test
	public void overrideProperty() {
		System.err.print("hello world");
		assertEquals("hello world", log.getLog());
	}
}
		</pre>

    <pre>
public void MyTest {
	&#064;Rule
	public final StandardOutputStreamLog log = new StandardOutputStreamLog();

	&#064;Test
	public void overrideProperty() {
		System.out.print("hello world");
		assertEquals("hello world", log.getLog());
	}
}
		</pre>

		<h2>System.in</h2>
		<p>With the TextFromStandardInputStream rule you are able to provide
		text, which is read by your code from System.in.</p>
		<pre>
public void MyTest {
	&#064;Rule
	public final TextFromStandardInputStream textFromStandardInputStream
	 = new TextFromStandardInputStream("foo");

	&#064;Test
	public void readTextFromStandardInputStream() {
		BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
		assertEquals("foo", reader.readLine());
	}
}
		</pre>

		<h2>System.exit()</h2>
		<p>If your code calls System.exit(), then your test stops and
		doesn't finish. The ExpectedSystemExit rule allows in-test
		specification of expected System.exit() calls.</p>
		<pre>
public void MyTest {
	&#064;Rule
	public final ExpectedSystemExit exit = ExpectedSystemExit.none();

	&#064;Test
	public void noSystemExit() {
		//passes
	}

	&#064;Test
	public void systemExitWithArbitraryStatusCode() {
		exit.expectSystemExit();
		System.exit(0);
	}

	&#064;Test
	public void systemExitWithSelectedStatusCode0() {
		exit.expectSystemExitWithStatus(0);
		System.exit(0);
	}
}
		</pre>

		<h2>Security Manager</h2>
		<p>If you need a special security manager to test your code, you may
		provide it by using the ProvideSecurityManager rule. This rule
		replaces the system's security manager with yours throughout the
		test</p>
		<pre>
public void MyTest {
	private final MySecurityManager securityManager
	 = new MySecurityManager();

	&#064;Rule
	public final ProvideSecurityManager provideSecurityManager
	 = new ProvideSecurityManager(securityManager);

	&#064;Test
	public void overrideProperty() {
		assertEquals(securityManager, System.getSecurityManager());
	}
}
		</pre>

      <h2>License</h2>
      <p>Common Public License Version 1.0</p>
    

    
      <h2>Authors</h2>
      <p>Marc Philipp (mail@marcphilipp.de)
<br/>Stefan Birkner (mail@stefan-birkner.de)
<br/>      </p>
    

    
      <h2>Contact</h2>
      <p>Stefan Birkner (mail@stefan-birkner.de)</p>
  </div>

  <script src="bootstrap.min.js"></script>
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-27382940-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</body>
</html>
